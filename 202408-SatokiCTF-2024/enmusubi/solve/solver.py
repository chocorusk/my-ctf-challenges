from ptrlib import *
from hashlib import sha256

client = Socket("nc localhost 5555")

p = 1151151150115115115115115115115011511511511501151151151151151151151151151150110011511511501151151151151151151150115115115115011511511511511511511511511511501100115115115011511511511511511511501151151151150115115115115115115115115115115011001151151150115115115115115115115011511511511501151151151151151151151151151150110115115115011511511511511511511501151151151150115115115115115115115115115115011011511511501151151151151151151150115115115115011511511511511511511511511511501101151151150115115115115115115115011511511511501151151151151151151151151151150110011511511501151151151151151151150115115115115011511511511511511511511511511501101
q = 115115115011511511511511511511501151151151150115115115115115115115115115115011

client.recvuntil(b'g = ')
g = int(client.recvline())
client.recvuntil(b'y = ')
y = int(client.recvline())
z = int(sha256(b'flag').hexdigest(), 16)

r = (1-pow(g, z, p)*y)%p * (p-1) + 1
s = 1

client.sendline(str(r).encode())
client.sendline(str(s).encode())

client.recvuntil(b'The flag is ')
print(client.recvline())
